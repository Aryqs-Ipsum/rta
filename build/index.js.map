{"mappings":"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","sources":["./src/gestures.ts","./src/index.ts"],"sourcesContent":["export default class Gestured {\r\n    el: HTMLElement;\r\n    offset: number;\r\n    scrollY: number;\r\n    scrollingTimeout: any;\r\n    isScrolling: boolean = false;\r\n    scrollBox: HTMLElement;\r\n    boxContent: HTMLElement;\r\n    closeCallback\r\n\r\n    constructor(el, closeCallback) {\r\n        this.el = el;\r\n        this.closeCallback = closeCallback;\r\n\r\n        this.scrollBox = this.el.querySelector('.rta__box')\r\n        if(this.scrollBox) {\r\n            this.scrollBox.addEventListener('scroll', (e) => {\r\n                this.isScrolling = true\r\n                window.clearTimeout( this.scrollingTimeout )\r\n                this.scrollingTimeout = setTimeout(function() {\r\n                    this.isScrolling = false\r\n                }, 66)\r\n            })\r\n        }\r\n\r\n        this.boxContent = this.el.querySelector('.rta__box-content')\r\n\r\n        // events\r\n        this.el.addEventListener('touchstart', this.panstart.bind(this))\r\n        this.el.addEventListener('touchmove', this.panmove.bind(this))\r\n        this.el.addEventListener('touchend', this.panend.bind(this))\r\n    }\r\n\r\n    panstart(e) {\r\n        this.scrollY = e.touches[0].clientY\r\n        this.el.style.transition = \"transform 0s\"\r\n    }\r\n  \r\n    panmove(e) {\r\n        this.offset = e.touches[0].clientY - this.scrollY\r\n        if(this.offset < 0 || !this.el.classList.contains('rta--opened')) return\r\n        if(this.scrollBox && this.isScrolling) {\r\n            if(this.scrollBox.scrollTop !== 0) return this.offset = 0\r\n        }\r\n        this.el.style.transform = `translate3D(0, ${this.offset}px, 0)`\r\n        if(this.boxContent)\r\n            this.boxContent.style.opacity = 1 - this.offset / window.innerHeight\r\n    }\r\n  \r\n    panend(e) {\r\n        this.el.style.transform = 'translate3D(0, 0, 0)'\r\n        this.el.style.transition = null\r\n        if(this.boxContent)\r\n            this.boxContent.style.opacity = null\r\n        if(this.offset > 150) {\r\n            this.offset = null\r\n            this.closeCallback(e)\r\n        }\r\n    }\r\n}","import Gestured from './gestures';\r\nimport './style.scss'\r\n\r\nexport default class RelToAbs {\r\n    el: HTMLElement\r\n    sections: Array<HTMLDivElement> = []\r\n    opened: boolean = false\r\n    placeholder: HTMLElement = null\r\n    options: object\r\n    defaultOptions: object = {\r\n        swipeToClose: true,\r\n        scrollToClose: false,\r\n        clickOutsideToClose: false,\r\n        scrollElement: document.body,\r\n        coloredPlaceholder: false\r\n    }\r\n\r\n    constructor(el, options = {}) {\r\n        this.el = el\r\n        this.options = Object.assign(this.defaultOptions, options)\r\n\r\n        // filter nodes and get only divs\r\n        this.el.childNodes.forEach(node => {\r\n            if(node.nodeName === 'DIV') {\r\n                this.sections.push(node)\r\n            }\r\n        })\r\n\r\n        // gestures \r\n        if(this.options.swipeToClose) {\r\n            new Gestured(this.el, this.close.bind(this))\r\n        }\r\n\r\n        // scroll to close\r\n        if(this.options.scrollToClose) {\r\n            this.options.scrollElement.addEventListener('scroll', this.close.bind(this))\r\n        }\r\n\r\n        // click outside to close\r\n        if(this.options.clickOutsideToClose) {\r\n            const backdrop = this.el.querySelector('.rta__backdrop')\r\n            backdrop.addEventListener('click', this.close.bind(this))\r\n        }\r\n\r\n        // close buttons\r\n        const closeButtons = this.el.querySelectorAll('.rta--close')\r\n        closeButtons.forEach(button => {\r\n            button.addEventListener('click', this.close.bind(this))\r\n        })\r\n\r\n        // open on click\r\n        this.el.addEventListener('click', this.open.bind(this))\r\n\r\n        this.el.classList.add('rta')\r\n    }\r\n\r\n    public open(event) {\r\n        if(this.opened) return\r\n        this.opened = true\r\n\r\n        // get divs dimensions \r\n        const position = this.getOffset(this.el)\r\n        const dimensions = {\r\n            width: this.el.offsetWidth,\r\n            height: this.el.offsetHeight\r\n        }\r\n\r\n        // create placeholder\r\n        this.createPlaceholder(dimensions)\r\n        \r\n        this.el.classList.add('rta--open')\r\n        this.el.style.top = position.top + 'px'\r\n        this.el.style.left = position.left + 'px'\r\n        this.el.style.width = dimensions.width + 'px'\r\n        this.el.style.height = dimensions.height + 'px'\r\n\r\n        if(!this.options.scrollToClose || this.options.swipeToClose) {\r\n            this.options.scrollElement.classList.add('rta--overflow-hidden')\r\n        }\r\n\r\n        setTimeout(() => {\r\n            this.el.classList.add('rta--opened')\r\n        }, 10)\r\n    }\r\n\r\n    public close(event) {\r\n        event.stopPropagation()\r\n        if(!this.opened) return\r\n        this.opened = false\r\n        navigator.vibrate(20)\r\n\r\n        this.el.classList.remove('rta--opened')\r\n\r\n        setTimeout(() => {\r\n            this.el.classList.remove('rta--open')\r\n            this.options.scrollElement.classList.remove('rta--overflow-hidden')\r\n            this.el.style.top = null\r\n            this.el.style.left = null\r\n            this.el.style.width = null\r\n            this.el.style.height = null\r\n            this.placeholder.remove()\r\n        }, 300)\r\n    }\r\n\r\n    private createPlaceholder(dimensions) {\r\n        this.placeholder = document.createElement('div')\r\n        this.placeholder.classList.add('rta__placeholder')\r\n        this.placeholder.style.width = dimensions.width + 'px'\r\n        this.placeholder.style.height = dimensions.height + 'px'\r\n        if(this.options.coloredPlaceholder)\r\n            this.placeholder.style.backgroundColor = this.options.coloredPlaceholder\r\n        this.el.parentNode.insertBefore(this.placeholder, this.el)\r\n    }\r\n\r\n    private getOffset(el) {\r\n        let x = 0\r\n        let y = 0\r\n        while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {\r\n            x += el.offsetLeft - el.scrollLeft\r\n            y += el.offsetTop - el.scrollTop\r\n            el = el.offsetParent\r\n        }\r\n        // remove scroll offset\r\n        x -= window.scrollX\r\n        y -= window.scrollY\r\n\r\n        return { top: y, left: x }\r\n    }\r\n\r\n}\r\n"],"names":["$3ee50679097aae8908e79647d8f985a6$export$default","isScrolling","constructor","el","closeCallback","this","scrollBox","querySelector","addEventListener","e","window","clearTimeout","scrollingTimeout","setTimeout","boxContent","panstart","bind","panmove","panend","scrollY","touches","clientY","style","transition","offset","classList","contains","scrollTop","transform","opacity","innerHeight","sections","opened","placeholder","defaultOptions","swipeToClose","scrollToClose","clickOutsideToClose","scrollElement","document","body","coloredPlaceholder","options","Object","assign","childNodes","forEach","node","nodeName","push","close","querySelectorAll","button","open","add","event","position","getOffset","dimensions","width","offsetWidth","height","offsetHeight","createPlaceholder","top","left","stopPropagation","navigator","vibrate","remove","createElement","backgroundColor","parentNode","insertBefore","x","y","isNaN","offsetLeft","offsetTop","scrollLeft","offsetParent","scrollX"],"version":3,"file":"index.js.map"}