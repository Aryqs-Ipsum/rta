require("./index.css");class t{isScrolling=!1;constructor(t,e){this.el=t,this.closeCallback=e,this.scrollBox=this.el.querySelector(".rta__box"),this.scrollBox&&this.scrollBox.addEventListener("scroll",(t=>{this.isScrolling=!0,window.clearTimeout(this.scrollingTimeout),this.scrollingTimeout=setTimeout((function(){this.isScrolling=!1}),66)})),this.boxContent=this.el.querySelector(".rta__box-content"),this.el.addEventListener("touchstart",this.panstart.bind(this)),this.el.addEventListener("touchmove",this.panmove.bind(this)),this.el.addEventListener("touchend",this.panend.bind(this))}panstart(t){this.scrollY=t.touches[0].clientY,this.el.style.transition="transform 0s"}panmove(t){if(this.offset=t.touches[0].clientY-this.scrollY,!(this.offset<0)&&this.el.classList.contains("rta--opened")){if(this.scrollBox&&this.isScrolling&&0!==this.scrollBox.scrollTop)return this.offset=0;this.el.style.transform=`translate3D(0, ${this.offset}px, 0)`,this.boxContent&&(this.boxContent.style.opacity=1-this.offset/window.innerHeight)}}panend(t){this.el.style.transform="translate3D(0, 0, 0)",this.el.style.transition=null,this.boxContent&&(this.boxContent.style.opacity=null),this.offset>150&&(this.offset=null,this.closeCallback(t))}}exports.default=class{sections=[];opened=!1;placeholder=null;defaultOptions={swipeToClose:!0,scrollToClose:!1,clickOutsideToClose:!1,scrollElement:document.body,coloredPlaceholder:!1};constructor(e,s={}){if(this.el=e,this.options=Object.assign(this.defaultOptions,s),this.el.childNodes.forEach((t=>{"DIV"===t.nodeName&&this.sections.push(t)})),this.options.swipeToClose&&new t(this.el,this.close.bind(this)),this.options.scrollToClose&&this.options.scrollElement.addEventListener("scroll",this.close.bind(this)),this.options.clickOutsideToClose){this.el.querySelector(".rta__backdrop").addEventListener("click",this.close.bind(this))}this.el.querySelectorAll(".rta--close").forEach((t=>{t.addEventListener("click",this.close.bind(this))})),this.el.addEventListener("click",this.open.bind(this)),this.el.classList.add("rta")}open(t){if(this.opened)return;this.opened=!0;const e=this.getOffset(this.el),s={width:this.el.offsetWidth,height:this.el.offsetHeight};this.createPlaceholder(s),this.el.classList.add("rta--open"),this.el.style.top=e.top+"px",this.el.style.left=e.left+"px",this.el.style.width=s.width+"px",this.el.style.height=s.height+"px",this.options.scrollToClose&&!this.options.swipeToClose||this.options.scrollElement.classList.add("rta--overflow-hidden"),setTimeout((()=>{this.el.classList.add("rta--opened")}),10)}close(t){t.stopPropagation(),this.opened&&(this.opened=!1,navigator.vibrate(20),this.el.classList.remove("rta--opened"),setTimeout((()=>{this.el.classList.remove("rta--open"),this.options.scrollElement.classList.remove("rta--overflow-hidden"),this.el.style.top=null,this.el.style.left=null,this.el.style.width=null,this.el.style.height=null,this.placeholder.remove()}),300))}createPlaceholder(t){this.placeholder=document.createElement("div"),this.placeholder.classList.add("rta__placeholder"),this.placeholder.style.width=t.width+"px",this.placeholder.style.height=t.height+"px",this.options.coloredPlaceholder&&(this.placeholder.style.backgroundColor=this.options.coloredPlaceholder),this.el.parentNode.insertBefore(this.placeholder,this.el)}getOffset(t){let e=0,s=0;for(;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-t.scrollLeft,s+=t.offsetTop-t.scrollTop,t=t.offsetParent;return e-=window.scrollX,s-=window.scrollY,{top:s,left:e}}};
//# sourceMappingURL=index.js.map
